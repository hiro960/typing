# UI/UX仕様書

気持ち良いユーザー体験の韓国語タイピング練習アプリ - UI/UX詳細仕様

---

# UX/UI設計原則（気持ち良い体験の実現）

## Forui適用ガイドライン
- **UIライブラリ**: Flutter 3.35+ / forui 0.15+ を標準採用。`pubspec.yaml` で `forui` と `forui_hooks` を追加し、すべての画面は `FTheme` コンテキスト配下で構築する。
- **テーマ構築**: `dart run forui theme create app_theme --light --dark` で `FThemeData` を生成し、`FColors`/`FTypography`/`FStyle` を一元管理。Material 3 の ColorScheme は Forui テーマからブリッジする。
- **スタイル拡張**: 主要ウィジェットのスタイルは CLI (`dart run forui style create buttons` など) で雛形を生成し、ブランドカラーや角丸を共通化する。`FButtonStyles` などは `lib/ui/styles/` 配下に配置。
- **レイアウト**: `FScaffold` + `FBottomNavigationBar` をアプリシェルに用い、タブ・シート・ダイアログは Forui の `FTabs`、`FSheet`、`FDialog` を基本とする。
- **フック**: 入力制御やアニメーションが必要な場合は `forui_hooks` を活用し、`useFBottomSheetController` 等で状態を整理する。
- **アクセシビリティ**: Forui が提供するローカライズ/I18nを有効化し、`FLocalizations` 設定で ja/ko/en を登録する。

## デザインコンセプト
- **シンプル & エレガント**: 余計な要素を排除し、学習に集中できるデザイン
- **楽しさ**: タイピングが楽しくなるような視覚的・聴覚的フィードバック
- **達成感**: 進捗が見えやすく、モチベーションを維持できる設計

## パフォーマンス目標
- **60fps以上の滑らかさ**: すべてのアニメーションとトランジション
- **起動時間**: 3秒以内（コールドスタート）
- **画面遷移**: 300ms以内のスムーズな遷移
- **入力レスポンス**: 16ms以内（1フレーム）で反応

## アニメーション・トランジション
### 画面遷移
- **ページ遷移**: スライド + フェードアニメーション（300ms）
- **モーダル**: 下から上へスライドイン / スケールアニメーション
- **リスト項目**: Staggered animation（時間差アニメーション）

### タイピング時のフィードバック
- **正解時**:
  - 文字が緑色に変化（100ms）
  - 軽いパルスエフェクト
  - 正解音（オプション、設定でON/OFF可能）
  - 軽い振動（ハプティクス: light impact）

- **不正解時**:
  - 文字が赤色に変化（100ms）
  - 横に軽く揺れるアニメーション（shake）
  - エラー音（オプション、設定でON/OFF可能）
  - 軽い振動（ハプティクス: medium impact）

- **レッスン完了時**:
  - 花吹雪アニメーション（confetti）
  - スコア表示のカウントアップアニメーション
  - 達成音
  - 成功振動（ハプティクス: success pattern）

### ローディング状態
- **スケルトンスクリーン**: コンテンツの形を示すプレースホルダー
- **シマーエフェクト**: 波打つような光のアニメーション
- **プログレスインジケーター**: 進捗がわかるローディング表示

## ハプティクスフィードバック（振動）
- **タップ**: light impact（ボタン押下時）
- **正解**: light impact（快適な軽い振動）
- **不正解**: medium impact（注意を促す振動）
- **レッスン完了**: success pattern（達成感のある振動パターン）
- **設定**: ON/OFF切り替え可能

## サウンドデザイン
- **キー入力音**: タイプライター風の心地よいクリック音（オプション）
- **正解音**: 短いポジティブな音（ピロリン）
- **不正解音**: 短いネガティブな音（ブー）だが不快にならない程度
- **レッスン完了音**: ファンファーレ風の音楽
- **BGM**: 集中できる落ち着いた音楽（オプション、設定でON/OFF）
- **音量調整**: すべての音が個別に調整可能

## カラーシステム
- `FThemeData.colors` に Forui カラーパレットを定義し、`FColors.primary/secondary/success/error/background` をアプリのトークンとする。CLI で生成された `app_theme.colors.dart` を編集して下記値を設定し、`forui theme apply` で再生成する。
- 状態色（hover/pressed/disabled）は `FWidgetStateMap` で制御し、`FButtonStyles` や `FTextFieldStyle` に注入する。

### ライトモード
- **プライマリカラー**: 温かみのある青系（#4A90E2）
- **セカンダリカラー**: アクセントのオレンジ系（#F5A623）
- **成功色**: 緑系（#7ED321）
- **エラー色**: 赤系（#D0021B）
- **背景**: ホワイト〜ライトグレーのグラデーション
- **テキスト**: ダークグレー（#333333）
- **サブテキスト**: ミディアムグレー（#666666）

### ダークモード
- **プライマリカラー**: 鮮やかな青系（#5FA3F0）
- **セカンダリカラー**: 柔らかいオレンジ系（#FFB84D）
- **成功色**: 明るい緑系（#8FDE5D）
- **エラー色**: 柔らかい赤系（#FF4757）
- **背景**: ダークグレー〜ブラックのグラデーション
- **テキスト**: ホワイト（#FFFFFF）
- **サブテキスト**: ライトグレー（#AAAAAA）

> `FTheme.maybeOf(context)` から `FColors` を取得し、カスタムウィジェットでも直接使用して一貫性を維持する。

## タイポグラフィ
- Forui の `FTypography` を Pretendard / Noto Sans CJK ベースで再定義し、`FThemeData.typography` に適用する。CLI (`dart run forui typography create app_typography`) で生成される `FHeadingStyle`, `FBodyStyle` を下記サイズで上書きする。
- **見出し**: Pretendard / Noto Sans CJK（韓国語対応）
  - H1: 32px, Bold
  - H2: 24px, Bold
  - H3: 20px, SemiBold
- **本文**: システムフォント（SF Pro / Roboto）+ Noto Sans CJK
  - Body1: 16px, Regular
  - Body2: 14px, Regular
  - Caption: 12px, Regular
- **タイピング表示**: 等幅フォント（Fira Code / JetBrains Mono）
  - 問題文: 28px
  - 入力文字: 28px
- **文字サイズ**: 3段階調整可能（小・中・大）
- アプリ設定から `FThemeScope` の `typography.withFontSize(multiplier)` を切り替え、再ビルド無しでフォントスケールを反映する。

## レスポンシブデザイン
- `FThemeData.breakpoints` を `small: 0-599`, `medium: 600-1023`, `large: 1024+` で設定し、`FScaffoldLayout` が自動でレイアウトを切り替えるようにする。
- 画面幅に応じて `FBottomNavigationBar` と `FSidebar` をスイッチし、タブレット以上ではサイドバー + コンテンツの 2 カラムに移行する。
- **スマートフォン**: 縦持ち最適化、片手操作を考慮
  - 幅: 375px 〜 428px
  - 下部のタブバーで主要機能にアクセス
- **タブレット**: 横持ち対応、2カラムレイアウト
  - 幅: 768px 〜 1024px
  - Forui の `FSidebar` + `FScaffoldBody` 構成
- **大画面対応**: 最大幅を制限し、中央寄せで読みやすく
  - 最大幅: 1200px

---

# 画面構成・遷移図

## メイン画面構成
```
アプリ起動
    ↓
スプラッシュ画面（3秒以内）
    ↓
ログイン状態チェック
    ├─ 未ログイン → オンボーディング画面 → ログイン/登録画面
    └─ ログイン済み → ホーム画面（タブバー）
```

## タブバー構成
```
┌─────────────────────────────────────┐
│                                     │
│         メインコンテンツエリア       │
│                                     │
├─────────────────────────────────────┤
│  📚     📝     ➕     🔔     👤     │
│ ホーム  日記  投稿  通知 プロフィール│
└─────────────────────────────────────┘
```
- `FScaffold` の `bottomNavigationBar` に `FBottomNavigationBar` を配置し、各タブは `FBottomNavigationBarDestination` で定義する。
- 角丸・高さは `bottomNavigationBarStyle` でトークン化し、iOS/Android で共通化。

### タブ1: ホーム（📚）
- レッスン一覧
- 学習進捗サマリー
- おすすめレッスン
- 継続日数（ストリーク表示）

### タブ2: 日記（📝）
- タイムライン（おすすめ/フォロー中/最新）
- 投稿一覧
- 検索機能

### タブ3: 投稿作成（➕）
- 新規投稿作成画面（モーダル）
- 文法ヒント
- テンプレート選択

### タブ4: 通知（🔔）
- 通知一覧
- いいね・コメント・フォロー通知

### タブ5: プロフィール（👤）
- 自分のプロフィール
- 統計・分析
- 設定

## 画面遷移フロー

### タイピング学習フロー
```
ホーム画面
    ↓ レッスン選択
レッスン詳細画面
    ↓ 開始ボタン
タイピング画面
    ↓ レッスン完了
結果画面（スコア・統計）
    ↓ 次のレッスン / ホームに戻る
```

### 日記投稿フロー
```
日記タブ
    ↓ 投稿ボタン（➕）
投稿作成画面（モーダル）
    ├─ テンプレート選択（オプション）
    ├─ 文法ヒント表示
    ├─ 画像添付（オプション）
    └─ 投稿ボタン
        ↓
日記タブ（投稿完了、トップに表示）
```

### プロフィール閲覧フロー
```
日記タブ
    ↓ 投稿のユーザー名タップ
他ユーザーのプロフィール画面
    ├─ 投稿一覧
    ├─ フォローボタン
    └─ 統計情報
```

---

# タイピング機能のUI

**詳細は docs/4_タイピング機能.md を参照**

---

# 日記機能のUI

## タイムライン画面
```
┌─────────────────────────────────┐
│  📝 日記              🔍        │  ← ヘッダー + 検索ボタン
├─────────────────────────────────┤
│  おすすめ | フォロー中 | 最新    │  ← タブ切り替え
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │ 投稿カード1              │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ 投稿カード2              │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ 投稿カード3              │   │
│  └─────────────────────────┘   │
│                                 │
│                                 │  ← スクロール可能
└─────────────────────────────────┘
```

## 投稿カード
```
┌─────────────────────────────────┐
│ @username  👤  ・ 2時間前       │  ← ユーザー情報 + 投稿時間
│ 중급자 (中級者) 🏅              │  ← 学習レベル
├─────────────────────────────────┤
│ 오늘은 한국 드라마를 봤어요.    │  ← 投稿本文
│ 정말 재미있었어요! 😊           │
│                                 │
│ #한국어공부 #드라마             │  ← ハッシュタグ
├─────────────────────────────────┤
│ [画像がある場合はここに表示]    │  ← 画像（最大4枚）
├─────────────────────────────────┤
│ ❤️ 24  💬 5  🔁 3  🔖          │  ← アクションボタン
│                                 │
│ [日本語で見る] ボタン（オプション）│  ← 翻訳機能
└─────────────────────────────────┘
```

### 投稿カードの要素
- **プロフィール画像**: 40x40px、円形
- **ユーザー名**: @username、14px、タップで遷移
- **投稿時間**: 相対時間表示（例: 2時間前、1日前）
- **学習レベルバッジ**: 초급자/중급자/상급자
- **本文**: 16px、最大280文字
- **ハッシュタグ**: 青色、タップで検索
- **画像**: アスペクト比16:9、タップで拡大表示
- **アクションボタン**:
  - ❤️ いいね: タップで即座にいいね、数値更新
  - 💬 コメント: タップでコメント画面へ
  - 🔁 リポスト: タップでリポスト確認ダイアログ
  - 🔖 ブックマーク: タップで保存

## 投稿作成画面（モーダル）
```
┌─────────────────────────────────┐
│  ✕  新規投稿          投稿  ⮕  │  ← ヘッダー
├─────────────────────────────────┤
│ [プロフィール画像] @username    │
├─────────────────────────────────┤
│ ┌─────────────────────────┐     │
│ │ 今日は何をしましたか？   │     │  ← テキスト入力エリア
│ │                         │     │  （最大280文字）
│ │                         │     │
│ │                         │     │
│ └─────────────────────────┘     │
│  [残り280文字]                  │  ← 文字数カウンター
├─────────────────────────────────┤
│  💡 文法ヒント                  │  ← 折りたたみ可能
│  ・오늘은 ~했어요（今日は〜）   │
│  ・날씨가 ~네요（天気が〜）     │
├─────────────────────────────────┤
│  📝 テンプレート                │  ← 折りたたみ可能
│  [日常] [感情] [学習] [推し活]   │
├─────────────────────────────────┤
│  📷  #  🌐                      │  ← アクションボタン
│  画像 タグ 翻訳                 │
└─────────────────────────────────┘
```
- `FSheet` + `FHeader` 構成で実装。本文入力は `FTextField.multiline`、テンプレート/文法ヒントは `FAccordion` で折りたたむ。
- 画像アップロードトリガーは `FButton.icon`、タグ選択は `FSelectMenuTile` を流用する。

## コメント画面
```
┌─────────────────────────────────┐
│  ← コメント           ⋮          │  ← ヘッダー
├─────────────────────────────────┤
│  元の投稿                        │
│  ┌─────────────────────────┐   │
│  │ @username の投稿         │   │  ← 簡易表示
│  │ 오늘은 한국 드라마를...   │   │
│  └─────────────────────────┘   │
├─────────────────────────────────┤
│  コメント一覧                    │
│  ┌─────────────────────────┐   │
│  │ @user1  ・ 1時間前       │   │
│  │ 좋아요! 어떤 드라마예요?  │   │
│  │ ❤️ 3                    │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ @user2  ・ 30分前        │   │
│  │ 저도 보고 싶어요!        │   │
│  │ ❤️ 1                    │   │
│  └─────────────────────────┘   │
├─────────────────────────────────┤
│ [プロフィール画像]              │
│ ┌─────────────────────────┐   │
│ │ コメントを追加...        │   │  ← コメント入力
│ └─────────────────────────┘ ⮕ │
└─────────────────────────────────┘
```
- コメントリストは `FTile`（または `FCard`）で構成し、`tileStyle` の間隔・角丸を統一。ヘッダーは `FHeader` を利用。
- 入力欄は `FTextField` + `FButton.icon` を横並びにし、`forui_hooks` の `useFTextFieldController` で状態管理。

## プロフィール画面
```
┌─────────────────────────────────┐
│  ←                      ⋮       │  ← ヘッダー（設定メニュー）
├─────────────────────────────────┤
│     [プロフィール画像 120x120]   │
│                                 │
│  표시명 (Display Name)          │  ← 表示名 20px Bold
│  @username                      │  ← ユーザー名 14px Gray
│                                 │
│  중급자 (中級者) 🏅             │  ← 学習レベル
│                                 │
│  自己紹介文が入ります...        │  ← 自己紹介 14px
│  最大160文字まで                │
│                                 │
│  📅 2024年1月から学習中         │  ← 学習開始日
│                                 │
│  ┌────────────────────┐         │
│  │ 📊 WPM最高: 78     │         │  ← 統計情報
│  │ ✅ 完了: 42レッスン │         │
│  │ ⏱️ 総時間: 12時間  │         │
│  └────────────────────┘         │
│                                 │
│  [フォローする]  [メッセージ]    │  ← アクションボタン
│                                 │
├─────────────────────────────────┤
│  📝 投稿  👥 フォロワー  ➕ フォロー中 │  ← タブ
│    42       128          56     │
├─────────────────────────────────┤
│                                 │
│  投稿一覧 / フォロワー / フォロー中 │  ← コンテンツエリア
│                                 │
└─────────────────────────────────┘
```

---

# コンポーネント設計

## 共通コンポーネント
- すべて Forui コンポーネントを採用し、必要に応じて `FThemeData` の widget styles を拡張する。CLI で生成したスタイルファイルは `lib/ui/styles/forui/` にまとめる。

### ボタン
- `FButton` + `FButtonStyles` を使用。Primary / Secondary / Text は style の `filled`, `outlined`, `text` を切り替えて表現。
- サイズ: 大（48px）、中（40px）、小（32px）を `buttonStyles.sizes` で指定し、`FSpacing` トークンを活用。

### カード
- `FCard` をベースに影・角丸を `FCardStyle` で定義。ホバー/押下時は `widgetState.resolve` でスケール 1.02 を付与。

### 入力フィールド
- `FTextField`/`FSelect`/`FPicker` を各フォームに使用。`FFormFieldStyle` で角丸8px・フォーカス色を設定し、エラー時は `state=error` で赤色ボーダーとメッセージを標準表示。

### モーダル / シート
- `FDialog` と `FSheet` を用途に応じて選択。投稿作成は `FSheet`（bottom sheet）、重要確認は `FDialog` を利用。背景オーバーレイは Forui デフォルト（opacity 0.5）を採用し、アニメーションは `FSheetController` で制御。

### トースト通知
- `FToast` を使い、種類ごとに `alertStyles` をマッピング。表示時間 3 秒、自動フェードアウト。

### アバター
- `FAvatar` で画像/イニシャルを表示。サイズは特大（120px）、大（64px）、中（40px）、小（24px）を `avatarStyle` で登録。

### バッジ
- `FBadge` を使い、学習レベル別に `success`/`info`/`purple` カラーを割り当て。テキストは `초급자/중급자/상급자` 固定。

---

# アイコン・画像リソース

## アイコンセット
### システムアイコン（Material Icons / SF Symbols）
- **ナビゲーション**: 戻る、次へ、閉じる、メニュー
- **アクション**: いいね、コメント、シェア、ブックマーク
- **コンテンツ**: 画像、動画、リンク、ハッシュタグ
- **設定**: 歯車、通知、プロフィール、ログアウト

### カスタムアイコン
- **タイピング**: キーボード、文字、チェックマーク
- **学習**: レッスン、進捗、統計、バッジ
- **ソーシャル**: フォロー、フォロワー、投稿

## 画像リソース
### スプラッシュ画面
- **ロゴ**: アプリロゴ、SVG形式
- **背景**: グラデーション

### オンボーディング
- **イラスト**: 3〜4枚、SVG形式
  1. タイピング学習の紹介
  2. 日記機能の紹介
  3. コミュニティの紹介

### エンプティステート
- **レッスンなし**: イラスト + 説明文
- **投稿なし**: イラスト + 説明文
- **フォロワーなし**: イラスト + 説明文

### エラー画面
- **ネットワークエラー**: イラスト + 再試行ボタン
- **404エラー**: イラスト + ホームに戻るボタン
- **サーバーエラー**: イラスト + 問い合わせリンク

---

# アクセシビリティ

## フォントサイズ調整
- **小**: 基本の90%
- **中**: 基本の100%（デフォルト）
- **大**: 基本の110%

## カラーコントラスト
- **WCAG AA準拠**: コントラスト比 4.5:1 以上
- **重要なテキスト**: コントラスト比 7:1 以上

## タッチターゲット
- **最小サイズ**: 44x44px（Apple HIG準拠）
- **間隔**: ターゲット間に8px以上のスペース

## スクリーンリーダー対応
- **セマンティクス**: Flutterのセマンティクス機能を活用
- **代替テキスト**: すべての画像・アイコンにラベル
- **フォーカス順序**: 論理的な順序

## キーボードナビゲーション
- **Tab**: 次の要素へ
- **Shift + Tab**: 前の要素へ
- **Enter/Space**: 選択・実行
- **Escape**: キャンセル・閉じる

---

# パフォーマンス最適化

## 画像最適化
- **フォーマット**: WebP形式優先、フォールバックPNG/JPEG
- **リサイズ**: サーバー側で適切なサイズに変換
- **遅延読み込み**: スクロール時に画像を読み込み
- **プレースホルダー**: ブラーハッシュ表示

## アニメーション最適化
- **GPU加速**: Transform、Opacityのみ使用
- **60fps維持**: 16ms以内の処理
- **減速**: 設定でアニメーション速度調整可能

## キャッシング
- **画像キャッシュ**: 最大100MB
- **APIレスポンスキャッシュ**: 5分間
- **ローカルDB**: SQLiteでオフライン対応
