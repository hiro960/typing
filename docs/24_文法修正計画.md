# 文法辞典カテゴリ再編成計画

## 概要

既存15カテゴリ（257項目）を11カテゴリに再編成し、`23_文法修正.md`の要求に合わせて全項目を確認・整理する。

## 現状と目標

### 既存カテゴリ構造（15カテゴリ、257項目）

| # | カテゴリID | 日本語名 | 項目数 |
|---|-----------|----------|--------|
| 1 | particle | 助詞 | 25 |
| 2 | ending | 語尾 | 35 |
| 3 | connective | 接続表現 | 22 |
| 4 | honorific | 敬語表現 | 15 |
| 5 | tense | 時制・相 | 12 |
| 6 | expression | 慣用表現 | 25 |
| 7 | numeral | 数詞・助数詞 | 22 |
| 8 | interrogative | 疑問詞 | 12 |
| 9 | pronoun | 代名詞・指示詞 | 15 |
| 10 | irregular | 不規則活用 | 10 |
| 11 | voice | 態 | 12 |
| 12 | quotation | 引用表現 | 11 |
| 13 | negation | 否定表現 | 7 |
| 14 | adverb | 副詞 | 24 |
| 15 | interjection | 感嘆詞・間投詞 | 12 |

### 新カテゴリ構造（11カテゴリ）

| # | カテゴリID | 日本語名 | 状態 | 対応する23_文法修正.mdのセクション |
|---|-----------|----------|------|-----------------------------------|
| 1 | orthography | 表記・発音 | **新規作成** | 1. 表記・発音 |
| 2 | substantive | 体言 | 統合 | 2. 体現カテゴリ |
| 3 | particle | 助詞 | 維持 | 3. 助詞カテゴリ |
| 4 | conjugation | 用言と活用 | 統合+新規 | 4. 用言と活用カテゴリ |
| 5 | sentence_ending | 終止形と待遇法 | 再編 | 5. 終止形と待遇法カテゴリ |
| 6 | connective | 接続形 | 維持 | 6. 接続形カテゴリ |
| 7 | adnominal | 連体形 | **新規作成** | 7. 連体形カテゴリ |
| 8 | tense_aspect | 時制 | 統合 | 8. 時制カテゴリ |
| 9 | expression | さまざまな表現 | 維持+拡張 | 9. さまざまな表現 |
| 10 | quotation | 直接話法と間接話法 | 維持 | 10. 直接話法と間接話法カテゴリ |
| 11 | word_formation | 単語の作り | **新規作成** | 11. 単語の作りカテゴリ |

## 移行マッピング

### 維持カテゴリ（そのまま）

| 移行元 | 移行先 | 項目数 |
|--------|--------|--------|
| particle | particle | 25 |
| connective | connective | 22 |
| quotation | quotation | 11 |
| expression | expression | 25 |

### 統合カテゴリ

| 移行元 | 移行先 | 項目数 |
|--------|--------|--------|
| pronoun + numeral + interrogative + honorific一部 | substantive | ~55 |
| irregular | conjugation | 10 |
| ending一部 + honorific一部 | sentence_ending | ~20 |
| tense + ending一部 | adnominal | ~10 |
| tense + negation + voice + honorific一部 | tense_aspect | ~35 |
| adverb一部 | word_formation | ~10 |
| adverb一部 | expression | ~10 |

### 削除カテゴリ

| カテゴリ | 項目数 | 理由 |
|---------|--------|------|
| interjection | 12 | 文法辞典の範囲外 |

## ID変更方針

既存のgrammarIdは新カテゴリに合わせて全て変更する。

### 変更例
- 旧: `grm_particle_001` → 新: `grm_particle_001`（維持カテゴリ）
- 旧: `grm_pronoun_001` → 新: `grm_substantive_001`
- 旧: `grm_numeral_001` → 新: `grm_substantive_016`（pronoun後の連番）
- 旧: `grm_irregular_001` → 新: `grm_conjugation_001`

## 新規作成項目

### orthography（表記・発音）- 約25項目

23_文法修正.mdの「1. 表記・発音」に対応：

| サブセクション | 項目 |
|---------------|------|
| ハングルの構造 | orthography_001 |
| 母音と字母 | orthography_002-004（単母音、半母音、二重母音） |
| 子音の字母（初声） | orthography_005-009（平音、激音、濃音、鼻音、流音） |
| 子音の字母（終声） | orthography_010 |
| 字母の名称と配列 | orthography_011 |
| 分かち書き | orthography_012 |
| 発音の変化 | orthography_013-022（終声の中和、連音化、etc.） |

### adnominal（連体形）- 約15項目

23_文法修正.mdの「7. 連体形カテゴリ」に対応：

| サブセクション | 項目 |
|---------------|------|
| 非過去連体形 | adnominal_001-003（作り方、意味） |
| 過去連体形 | adnominal_004-006（作り方、意味） |
| 意志・推量連体形 | adnominal_007-012（作り方、意味、特殊用法） |

### conjugation追加分（用言と活用）- 約20項目

23_文法修正.mdの「4. 用言と活用カテゴリ」に対応：

| サブセクション | 項目 |
|---------------|------|
| 韓国語の用言と品詞 | conjugation_001-002 |
| 語幹・語尾・接尾辞 | conjugation_003 |
| 活用の記述方法 | conjugation_004-006（第Ⅰ～Ⅲ語基） |
| 規則用言の活用 | conjugation_007-009 |
| 不規則用言の活用 | conjugation_010-021（既存irregular移行） |
| その他の特殊な活用 | conjugation_022-025 |

### word_formation（単語の作り）- 約15項目

23_文法修正.mdの「11. 単語の作りカテゴリ」に対応：

| サブセクション | 項目 |
|---------------|------|
| 副詞形 | word_formation_001-002（-리/-이/-히, I-게） |
| 体言形 | word_formation_003-005（I-기, Ⅱ-ㅁ, 派生名詞） |
| 接頭辞 | word_formation_006-007（固有語、漢字語） |
| 接尾辞 | word_formation_008-011（固有語、数量、複数、用言） |

## 実装フェーズ

### Phase 1: 準備
1. 全257項目のJSON内容確認
2. 詳細な移行マッピング表作成
3. 新カテゴリ用ディレクトリ作成

### Phase 2: Dartコード更新
1. `grammar_models.dart` のGrammarCategory enum更新
2. 拡張メソッド（label, description, icon）更新

### Phase 3: 既存項目の移行
1. JSONファイルのカテゴリ属性変更
2. ファイル名・ID変更
3. relatedGrammar参照更新

### Phase 4: grammar_index.json再構築
1. 新カテゴリ構造でインデックス作成
2. 全項目のエントリ追加

### Phase 5: 新規項目のJSON作成
1. orthography（表記・発音）
2. adnominal（連体形）
3. conjugation追加分
4. word_formation（単語の作り）

### Phase 6: テストと調整
1. JSON構文チェック
2. 参照整合性確認
3. UI表示確認

## 変更対象ファイル

### Dartファイル
- `application/lib/features/grammar/data/models/grammar_models.dart`

### アセットファイル
- `application/assets/grammar/grammar_index.json`
- `application/assets/grammar/{category}/*.json`

### ディレクトリ操作
```bash
# 新規作成
mkdir -p application/assets/grammar/{orthography,substantive,conjugation,sentence_ending,adnominal,tense_aspect,word_formation}

# 移行完了後に削除
rm -rf application/assets/grammar/{honorific,irregular,negation,voice,adverb,interjection,pronoun,numeral,interrogative,tense,ending}
```

## 注意事項

1. **お気に入りデータの互換性**: grammarIdが変更されるため、既存のお気に入りデータは無効になる
2. **relatedGrammarの参照**: 全ての相互参照を新IDに更新する必要がある
3. **バリデーション**: JSON構文エラーや参照切れを防ぐためのチェックを実施

## 関連ドキュメント

- `docs/21_文法辞典機能の詳細.md` - 機能仕様
- `docs/22_文法辞典JSONファイル作成指示書.md` - JSONフォーマット仕様
- `docs/23_文法修正.md` - 修正要件
